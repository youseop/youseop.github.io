---
layout: post
title: BAEKJOON#2042 êµ¬ê°„ í•© êµ¬í•˜ê¸°
subtitle: Python
cover-img: /assets/img/posting/mountain.jpg
thumbnail-img: /assets/img/posting/baekjoonrect.png
share-img: /assets/img/posting/mountain.jpg
tags: [Segment Tree, BAEKJOON]
comments: true
---

## [êµ¬ê°„ í•© êµ¬í•˜ê¸°](https://www.acmicpc.net/problem/2042)

<br>

Segment Treeë¥¼ ì´ìš©í•´ êµ¬ê°„ í•©ì„ êµ¬í•˜ëŠ” ë¬¸ì œë‹¤.

Segment Treeì˜ ë¦¬í”„ ë…¸ë“œ(ìì‹ ë…¸ë“œê°€ ì—†ëŠ” ë…¸ë“œ)ëŠ” ì£¼ì–´ì§„ ë°°ì—´ì˜ ìˆ«ìë¥¼ ì €ì¥í•˜ê³ , ë‚˜ë¨¸ì§€ ë…¸ë“œëŠ” ìì‹ ë…¸ë“œë“¤ì˜ í•©ì„ ì €ì¥í•œë‹¤.

### Segment Tree êµ¬í˜„

'a = [1, 2, 3, 4, 5, 6]'ë¡œ Segment Treeë¥¼ êµ¬ì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

<br>

![Crepe](https://i.imgur.com/DuGDEjU.jpg)

<br>

- ê°€ì¥ ìœ„ì— ìœ„ì¹˜í•œ 1ë²ˆ ë…¸ë“œëŠ” 0ë²ˆì§¸ ~ 5ë²ˆì§¸ ì›ì†Œì˜ í•©ì„ ì €ì¥í•œë‹¤.
- ìì‹ ë…¸ë“œì¸ 2ë²ˆ ë…¸ë“œì™€ 3ë²ˆ ë…¸ë“œì—ëŠ” 0ë²ˆì§¸ ~ (0+5)/2ë²ˆì§¸ ì›ì†Œì˜ í•©ê³¼ (0+5)/2+1ë²ˆì§¸ ~ 5ë²ˆì§¸ ì›ì†Œì˜ í•©ì„ ì €ì¥í•œë‹¤.
- ì´ë ‡ê²Œ í•©ì„ ì €ì¥í•˜ë©° ë‚´ë ¤ê°€ë‹¤ê°€ ë” ì´ìƒ ë‚˜ë‰  ìˆ˜ ì—†ì„ ë•Œ í•´ë‹¹ ë…¸ë“œì— a[i]ê°’ì„ ì €ì¥í•˜ê²Œ ëœë‹¤.
- ë…¸ë“œ ë²ˆí˜¸ëŠ” ìœ„ì—ì„œ ë¶€í„°, ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ 1ì”© ì¦ê°€í•˜ë©° ë§¤ê²¨ì§„ë‹¤.
- ë…¸ë“œ ë²ˆí˜¸ê°€ Xì¼ë•Œ, ìì‹ ë…¸ë“œì˜ ë²ˆí˜¸ëŠ” 'X*2'ì™€ 'X*2+1'ì´ë‹¤. 

ë¦¬ìŠ¤íŠ¸ì— í•´ë‹¹ ë…¸ë“œ ë²ˆí˜¸ ì •ë³´ë¥¼ ì´ìš©í•´ ê°’ì„ ì €ì¥í•œë‹¤. 

---

'tree'ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ì—¬ê¸°ì— ê° ë…¸ë“œì˜ ê°’ë“¤ì„ ì €ì¥í–ˆë‹¤.
ì´ë•Œ, 'ì›ì†Œì˜ ê°œìˆ˜*4' ë§Œí¼ì˜ ê¸¸ì´ë¡œ tree ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì—ˆë‹¤.

<br>

![Crepe](https://i.imgur.com/jaqk9WA.jpg)

f(x)ëŠ” xê°œì˜ ì›ì†Œë¥¼ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¡œ êµ¬í˜„í•  ë•Œ í•„ìš”í•œ ë…¸ë“œì˜ ê°œìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤.
ìœ„ì˜ ì‹ì„ í†µí•´ f(x)ê°€ í•­ìƒ x*4 ì´í•˜ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

```python
n,m,k=map(int,read().split())
a=list(int(read()) for _ in range(n))
tree = [0]*(4*n)

#ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ êµ¬ì„±
def tree_init(start, end, node):
    if start == end:
        tree[node] = a[start]
        return tree[node]
    mid = (start + end)//2

    #íŠ¹ì • ë…¸ë“œì˜ í•˜ìœ„ ë…¸ë“œ ë²ˆí˜¸ëŠ” node*2ì™€ node*2+1ì´ë‹¤.
    tree[node] = tree_init(start, mid, node*2) + tree_init(mid + 1, end, node*2+1)
    return tree[node]
    
tree_init(0, n-1, 1)
```

<br>

---

### Segment Tree êµ¬ê°„í•© êµ¬í•˜ê¸°

'a = [1, 2, 3, 4, 5, 6]'ì—ì„œ 0ë²ˆì§¸ ì›ì†Œë¶€í„° 4ë²ˆì§¸ ì›ì†Œê¹Œì§€ì˜ êµ¬ê°„í•©ì„ êµ¬í•´ë³´ì.

![Crepe](https://i.imgur.com/e3sjRi1.jpg)

<br>
- 1ë²ˆì§¸ ë…¸ë“œë¶€í„° íƒìƒ‰ì„ ì‹œì‘í•œë‹¤.
- 0 - 5ëŠ” 0 - 4ì™€ ê²¹ì¹˜ê¸´ í•˜ì§€ë§Œ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¨ìœ¼ë¡œ ìì‹ë…¸ë“œë¡œ ì´ë™í•´ íƒìƒ‰ì„ ì´ì–´ê°„ë‹¤.
- 0 - 2ëŠ” 0 - 4ì˜ ë²”ìœ„ì— í¬í•¨ëœë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ë…¸ë“œì˜ ê°’ì„ ë”í•´ì¤€ë‹¤.
- 3 - 5ëŠ” 0 - 4ì™€ ê²¹ì¹˜ê¸´ í•˜ì§€ë§Œ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¨ìœ¼ë¡œ ìì‹ë…¸ë“œë¡œ ì´ë™í•´ íƒìƒ‰ì„ ì´ì–´ê°„ë‹¤.
- 3 - 4ëŠ” 0 - 4ì˜ ë²”ìœ„ì— í¬í•¨ëœë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ë…¸ë“œì˜ ê°’ì„ ë”í•´ì¤€ë‹¤.
- 5 - 5ëŠ” 0 - 4ì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¨ìœ¼ë¡œ 0ì„ returní•´ ì•„ë¬´ê²ƒë„ ë”í•´ì£¼ì§€ ì•ŠëŠ”ë‹¤.

<br>

```python
#êµ¬ê°„í•© êµ¬í•˜ëŠ” í•¨ìˆ˜
def tree_sum(start, end, node, left, right):

    #ë²”ìœ„ë¥¼ ë²—ì–´ë‚  ë•Œ
    if left > end or right < start:
        return 0

    #ë²”ìœ„ê°€ leftì™€ rightì‚¬ì´ì— ìˆì„ ë•ŒëŠ” í•´ë‹¹ ë…¸ë“œì˜ ê°’ì„ returní•´ ë”í•´ì¤€ë‹¤.
    if left <= start and end <= right:
        return tree[node]

    mid = (start + end)//2

    #ë²”ìœ„ê°€ ê²¹ì¹˜ê¸´ í•˜ì§€ë§Œ í¬í•¨ë˜ì§€ëŠ” ì•ŠëŠ” ê²½ìš° í•˜ìœ„ ë…¸ë“œë¥¼ íƒìƒ‰í•œë‹¤.
    return tree_sum(start, mid, node*2, left, right) + tree_sum(mid + 1, end, node*2+1, left, right)
```

<br>

---

### Segment Tree ì›ì†Œì˜ ê°’ ë³€ê²½í•˜ê¸°

'a = [1, 2, 3, 4, 5, 6]'ì—ì„œ 4ë²ˆì§¸ ì›ì†Œì˜ ê°’ì„ 5ì—ì„œ 7ë¡œ ë³€ê²½í•´ë³´ì.

![Crepe](https://i.imgur.com/kZGBrqh.jpg)

<br>

- ê¸°ì¡´ 4ë²ˆì§¸ ì›ì†Œì˜ ê°’ê³¼ 7ì˜ ì°¨ì´ëŠ” +2ì´ë‹¤. ë”°ë¼ì„œ 4ë¥¼ í¬í•¨í•˜ëŠ” ëª¨ë“  ë…¸ë“œì˜ ê°’ì— 2ë¥¼ ë”í•´ì£¼ë©´ ëœë‹¤.
- ê°’ì„ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê³¼ì • ì—­ì‹œ 1ë²ˆ ë…¸ë“œë¶€í„° íƒìƒ‰í•´ë³´ì.
- 1ë²ˆ ë…¸ë“œëŠ” ë‹¹ì—°íˆ 4ë²ˆì§¸ ì›ì†Œë¥¼ í¬í•¨í•œë‹¤. 2ë¥¼ ë”í•´ì£¼ê³  ìì‹ ë…¸ë“œë¡œ ì´ë™í•œë‹¤.
- 2ë²ˆ ë…¸ë“œëŠ” 4ë²ˆì§¸ ì›ì†Œë¥¼ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤. returnìœ¼ë¡œ íƒìƒ‰ì„ ì¢…ë£Œí•œë‹¤.
- 3ë²ˆ ë…¸ë“œëŠ” 4ë²ˆì§¸ ì›ì†Œë¥¼ í¬í•¨í•œë‹¤. 2ë¥¼ ë”í•´ì£¼ê³  ìì‹ë…¸ë“œë¡œ ì´ë™í•˜ì.
- ìœ„ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ë¦¬í”„ ë…¸ë“œì— ë„ì°©í•  ë•Œ ê¹Œì§€ íƒìƒ‰ì„ ì§„í–‰í•œë‹¤.

<br>

```python
#ê°’ì„ ì—…ë°ì´íŠ¸í•´ì£¼ëŠ” í•¨ìˆ˜
def tree_update(start,end,node,index,diff):

    #ë²”ìœ„ê°€ indexë¥¼ í¬í•¨í•˜ì§€ ì•Šìœ¼ë©´ ë³„ë„ë¡œ ìˆ˜ì •í•  í•„ìš”ê°€ ì—†ë‹¤.
    if index < start or index > end:
        return

    #ìœ„ì˜ ifë¬¸ì—ì„œ returnë˜ì§€ ì•Šì€ ê²½ìš° indexë¥¼ í¬í•¨í•˜ê³  ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.
    tree[node] += diff

    #startì™€ endê°€ ê°™ì•„ì•¼ í•˜ìœ„ ë…¸ë“œê¹Œì§€ ë„ì°©í–ˆë‹¤ëŠ” ëœ»ì´ë‹¤.
    #startì™€ endê°€ ê°™ì„ ë•Œ ê¹Œì§€ í•˜ìœ„ ë…¸ë“œë¡œ ì´ë™í•´ í•´ë‹¹ë…¸ë“œì— diffë¥¼ ë”í•´ì¤€ë‹¤.
    if start != end:
        mid = (start + end)//2
        tree_update(start, mid ,node*2, index, diff)
        tree_update(mid+1, end ,node*2+1, index, diff)
```

<br>

---

### CODE

```python
import sys
read=sys.stdin.readline

#ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ êµ¬ì„±
def tree_init(start, end, node):
    if start == end:
        tree[node] = a[start]
        return tree[node]
    mid = (start + end)//2

    #íŠ¹ì • ë…¸ë“œì˜ í•˜ìœ„ ë…¸ë“œ ë²ˆí˜¸ëŠ” node*2ì™€ node*2+1ì´ë‹¤.
    tree[node] = tree_init(start, mid, node*2) + tree_init(mid + 1, end, node*2+1)
    return tree[node]

#êµ¬ê°„í•© êµ¬í•˜ëŠ” í•¨ìˆ˜
def tree_sum(start, end, node, left, right):

    #ë²”ìœ„ë¥¼ ë²—ì–´ë‚  ë•Œ
    if left > end or right < start:
        return 0

    #ë²”ìœ„ê°€ leftì™€ rightì‚¬ì´ì— ìˆì„ ë•ŒëŠ” í•´ë‹¹ ë…¸ë“œì˜ ê°’ì„ returní•´ ë”í•´ì¤€ë‹¤.
    if left <= start and end <= right:
        return tree[node]

    mid = (start + end)//2

    #ë²”ìœ„ê°€ ê²¹ì¹˜ê¸´ í•˜ì§€ë§Œ í¬í•¨ë˜ì§€ëŠ” ì•ŠëŠ” ê²½ìš° í•˜ìœ„ ë…¸ë“œë¥¼ íƒìƒ‰í•œë‹¤.
    return tree_sum(start, mid, node*2, left, right) + tree_sum(mid + 1, end, node*2+1, left, right)

#ê°’ì„ ì—…ë°ì´íŠ¸í•´ì£¼ëŠ” í•¨ìˆ˜
def tree_update(start,end,node,index,diff):

    #ë²”ìœ„ê°€ indexë¥¼ í¬í•¨í•˜ì§€ ì•Šìœ¼ë©´ ë³„ë„ë¡œ ìˆ˜ì •í•  í•„ìš”ê°€ ì—†ë‹¤.
    if index < start or index > end:
        return

    #ìœ„ì˜ ifë¬¸ì—ì„œ returnë˜ì§€ ì•Šì€ ê²½ìš° indexë¥¼ í¬í•¨í•˜ê³  ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.
    tree[node] += diff

    #startì™€ endê°€ ê°™ì•„ì•¼ í•˜ìœ„ ë…¸ë“œê¹Œì§€ ë„ì°©í–ˆë‹¤ëŠ” ëœ»ì´ë‹¤.
    #startì™€ endê°€ ê°™ì„ ë•Œ ê¹Œì§€ í•˜ìœ„ ë…¸ë“œë¡œ ì´ë™í•´ í•´ë‹¹ë…¸ë“œì— diffë¥¼ ë”í•´ì¤€ë‹¤.
    if start != end:
        mid = (start + end)//2
        tree_update(start, mid ,node*2, index, diff)
        tree_update(mid+1, end ,node*2+1, index, diff)


n,m,k=map(int,read().split())
a=list(int(read()) for _ in range(n))
tree = [0]*(4*n)

tree_init(0, n-1, 1)

for _ in range(m+k):
    x,y,z=map(int,read().split())
    if x == 1:
        y-=1
        diff = z - a[y]
        a[y] = z
        tree_update(0, n-1, 1, y, diff)
    else:
        print(tree_sum(0, n-1, 1, y-1, z-1))
```

<br>
í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”¼ë“œë°± ì£¼ì‹œë©´ ê³ ì¹˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤!
ê°ì‚¬í•©ë‹ˆë‹¤.ğŸ‘

[ê¼­ ë‹¤ì‹œ í’€ì–´ë³´ê¸°]
<br>
<br>
